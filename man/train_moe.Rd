% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/moe_classifier.R
\name{train_moe}
\alias{train_moe}
\title{Train a MoE text classifier}
\usage{
train_moe(
  classifier,
  data,
  text_col,
  label_col,
  epochs = 3,
  batch_size = 8,
  learning_rate = 5e-05,
  validation_split = 0.2,
  verbose = TRUE
)
}
\arguments{
\item{classifier}{MoE classifier object}

\item{data}{Training data frame}

\item{text_col}{Column name containing text (unquoted or string)}

\item{label_col}{Column name containing labels (unquoted or string)}

\item{epochs}{Number of training epochs}

\item{batch_size}{Batch size for training}

\item{learning_rate}{Learning rate for optimizer}

\item{validation_split}{Fraction of data to use for validation}

\item{verbose}{Whether to print training progress (default: TRUE)}
}
\value{
Updated classifier object with trained model
}
\description{
Trains a Mixture of Experts classifier on labeled data. The training process
includes both classification loss and load balancing loss to encourage diverse
expert usage.
}
\details{
The MoE training process optimizes:
\itemize{
  \item Classification loss (cross-entropy)
  \item Load balancing loss (encourages diverse expert usage)
}

During training, the gating network learns to route different inputs to
different experts, potentially allowing specialization (e.g., one expert
for positive sentiment, another for negative).
}
\examples{
\dontshow{if (requireNamespace("transformers")) withAutoprint(\{ # examplesIf}
library(dplyr)

data <- tibble::tibble(
  text = c("I feel happy", "I am sad", "I love this"),
  emotion = c("joy", "sadness", "love")
)
clf <- moe_classifier(num_labels = 3, num_experts = 3) |>
  train_moe(data, text, emotion, epochs = 3)
\dontshow{\}) # examplesIf}
}
\seealso{
\code{\link{moe_classifier}}, \code{\link{predict.moe_classifier}}
}
